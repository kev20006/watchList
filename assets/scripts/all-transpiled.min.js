function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _get(t,e,a){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var n=_superPropBase(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(a):s.value}})(t,e,a||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var tmdb={key:"405219586381645a0c87c4c5dc9211d9",getURL:function(t,e){switch(e.page||(e.page=1),t){case"movie search":return"https://api.themoviedb.org/3/search/movie?api_key=".concat(tmdb.key)+"&language=en-US&query=".concat(e.terms)+"&page=".concat(e.page);case"movie details":return"https://api.themoviedb.org/3/movie/".concat(e.id,"?api_key=").concat(tmdb.key)+"&language=en-US&append_to_response=credits";case"cinema now":return"https://api.themoviedb.org/3/movie/now_playing?api_key=".concat(tmdb.key)+"&language=en-US"+"&page=".concat(e.page);case"top movies":return"https://api.themoviedb.org/3/movie/top_rated?api_key=".concat(tmdb.key)+"&language=en-US"+"&page=".concat(e.page);case"movie genre":return"https://api.themoviedb.org/3/discover/movie?api_key=".concat(tmdb.key)+"&language=en-us&"+"with_genres=".concat(e.id)+"&page=".concat(e.page);case"tv genre":return"https://api.themoviedb.org/3/discover/tv?api_key=".concat(tmdb.key)+"&language=en-us&with_genres=".concat(e.id)+"&page=".concat(e.page);case"movie actor":return"https://api.themoviedb.org/3/person/".concat(e.id,"?api_key=").concat(tmdb.key)+"&append_to_response=movie_credits";case"tv search":return"https://api.themoviedb.org/3/search/tv?api_key=".concat(tmdb.key)+"&language=en-US&query=".concat(e.terms,"&")+"page=".concat(e.page);case"tv details":return"https://api.themoviedb.org/3/tv/".concat(e.id,"?api_key=").concat(tmdb.key)+"&language=en-US&append_to_response=credits";case"tv now":return"https://api.themoviedb.org/3/tv/on_the_air?api_key=".concat(tmdb.key)+"&language=en-US"+"&page=".concat(e.page);case"top tv":return"https://api.themoviedb.org/3/tv/top_rated?api_key=".concat(tmdb.key)+"&language=en-US"+"&page=".concat(e.page);case"tv recommendations":return"https://api.themoviedb.org/3/tv/".concat(e.id,"/recommendations?api_key=").concat(tmdb.key)+"&language=en-US&page=1";case"tv today":return"https://api.themoviedb.org/3/tv/airing_today?api_key=".concat(tmdb.key)+"&language=en-US"+"&page=".concat(e.page);case"person search":return"https://api.themoviedb.org/3/search/person?api_key=".concat(tmdb.key)+"&language=en-US"+"&query=".concat(e.terms)+"&page=".concat(e.page)}},getObjects:function(t,e){var a=[];"search"==t.listType?a=tmdb.getSearchResults({type:t.type,terms:t.terms,page:t.page}):"recommendations"==t.listType&&(a=tmdb.getRecommendations(t)),a.then(function(a){var n=a.total_pages;if("movie actor"==t.recType)if(n=Math.floor(a.movie_credits.cast.length/10+1)/2,t.page){var s=10*t.page-1;s>a.movie_credits.cast.length&&(s=a.movie_credits.cast.length);var i=10*(t.page-1);a=a.movie_credits.cast.slice(i,s)}else a=[a.movie_credits.cast[randomIndex(a.movie_credits.cast.length)]];else a="movie genre"==t.recType?t.page?a.results:[a.results[randomIndex(a.results.length)]]:a.results;var c=[];a.forEach(function(e){e.type=t.type,c.push(tmdb.makeWatchItem(e))}),e(c,n)}).catch(function(a){429==a.status?(showWarning('Maximum Requests made.Retrying Request in\n                    <span id="warning-time-left"></span>\n                    Seconds - click to close this warning'),setTimeout(function(){tmdb.getObjects(t,e)},8e3)):(le.logconso("Catching Movie List Error"),console.log(a))})},getSearchResults:function(t){return Promise.resolve($.getJSON(tmdb.getURL("".concat(t.type," search"),{terms:t.terms,page:t.page})))},getDetails:function(t){return Promise.resolve($.getJSON(tmdb.getURL("".concat(t.type," details"),{id:t.id})))},getRecommendations:function(t){return Promise.resolve($.getJSON(tmdb.getURL(t.recType,{id:t.id,page:t.page})))},getGenres:function(t){return Promise.resolve($.getJSON("https://api.themoviedb.org/3/genre/".concat(t,"/list?api_key=").concat(tmdb.key,"&language=en-US")))},getEpisodeName:function(t,e,a,n){var s="https://api.themoviedb.org/3/tv/".concat(t,"/season/").concat(e,"/episode/").concat(a,"?api_key=405219586381645a0c87c4c5dc9211d9&language=en-US");$.getJSON(s).then(function(t){n(t)})},makeWatchItem:function(t){var e="",a="https://image.tmdb.org/t/p/w92",n="https://image.tmdb.org/t/p/w600_and_h900_bestv2",s=[];t.genre_ids.forEach(function(e){watchList.details["".concat(t.type,"Genres")].forEach(function(t){t.id==e&&s.push({name:t.name,id:t.id})})}),null==t.poster_path?(a="./assets/images/no-movie-found.png",n="./assets/images/no-movie-found.png"):(a+=t.poster_path,n+=t.poster_path);var i=null,c="";return"movie"==t.type?(e='<i class="fas fa-film m-1"></i>',i=t.release_date.split("-")[0],c=t.title):(e='<i class="fas fa-tv m-1"></i>',i=t.first_air_date.split("-")[0],c=t.name),new watchItem({icon:e,dbid:t.id,type:t.type,title:c,genre:s,thumb:a,lrgImage:n,longDescription:t.overview,year:i})},makeMovieObject:function(t){var e="https://image.tmdb.org/t/p/w92",a="https://image.tmdb.org/t/p/w600_and_h900_bestv2",n="None Given";t.credits.crew.forEach(function(t){"Director"==t.job&&(n=t.name)});for(var s=[],i=0;i<=3;i++)t.credits.cast[i]&&s.push(t.credits.cast[i]);return null==t.poster_path?(e="./assets/images/no-movie-found.png",a="./assets/images/no-movie-found.png"):(e+=t.poster_path,a+=t.poster_path),new movie({dbid:t.id,title:t.title,thumb:e,lrgImage:a,longDescription:t.overview,year:t.release_date.split("-")[0],genre:t.genres,note:"",director:n,rating:10*t.vote_average,cast:s})},makeTvObject:function(t){var e="https://image.tmdb.org/t/p/w92",a="https://image.tmdb.org/t/p/w600_and_h900_bestv2";t.poster_path?(e+=t.poster_path,a+=t.poster_path):(e="./assets/images/no-tv-found.png",a="./assets/images/no-tv-found.png");for(var n=[],s=0;s<=3;s++)t.credits.cast[s]&&n.push(t.credits.cast[s]);var i=null;t.first_air_date&&(i=t.first_air_date.split("-")[0]);var c=[];return t.seasons.forEach(function(t){for(var e=[],a=0;a<t.episode_count;a++)e.push({watched:!1,episode:a+1});c.push({name:t.name,episodes:e})}),new tv({dbid:t.id,title:t.name,thumb:e,lrgImage:a,longDescription:t.overview,year:i,genre:t.genres,note:"",rating:10*t.vote_average,cast:n,lastEpisode:t.last_episode_to_air,nextEpisode:t.next_episode_to_air,seasons:t.seasons,epTracker:c})}},watchItem=function(){"use strict";function t(e){_classCallCheck(this,t),this.icon=e.icon,this.dbid=e.dbid,this.type=e.type,this.title=e.title,this.thumb=e.thumb,this.lrgImage=e.lrgImage,void 0==e.longDescription?(this.longDescription="no description given",this.shortDescription="no description given"):(this.longDescription=e.longDescription,e.longDescription.length<=200?this.shortDescription=e.longDescription:this.shortDescription="".concat(e.longDescription.substring(0,200),"...")),this.year=e.year,this.genre=e.genre,this.note=e.note,this.searchItem=this.searchItem.bind(this),this.itemPreview=this.itemPreview.bind(this),this.updateTags=this.updateTags.bind(this),this.updateCardTags=this.updateCardTags.bind(this)}return _createClass(t,[{key:"searchItem",value:function(t){var e=this,a=$('<div class="result row pt-2 mx-0"></div>'),n=$('<div class="col-3 col-offset-2 "></div>'),s=$('<div class="col-7"></div>'),i=$('<p class="my-0 d-flex flex-wrap"></p>');this.genre.forEach(function(t){i.append('<span class="mr-2 mb-1 collection-tag">'.concat(t.name,"</span>"))}),n.append("<img src=".concat(this.thumb,' class="result-thumb mx-auto d-block" alt=').concat(this.title.substring(0,50)," />")),s.append('<h6 class="result-title"><strong class="heading">'.concat(this.title.substring(0,40),"</strong> - ").concat(this.year,"</h6>"),i),a.on("click",function(){var a="search";t&&(a="actorSearch"),buttonControls.preview(e,a)});var c=$('<div class="col-2 px-0"></div>'),o=$('<div class="add d-flex justify-content-center align-items-center mr-2"> \n                            <i class="fas fa-plus my-0"></i>\n\t\t\t\t\t\t\t</div>').on("click",function(){buttonControls.add(e,"search")});return c.append(o),a.append(n,s,c),a}},{key:"itemPreview",value:function(t){var e=this,a=$('<div class="row mx-0 preview"></div>'),n=$('<header class="col-12 prev-head"></header>'),s=$('<div class="row mx-0 p-2"></div>'),i=$("<h3>".concat(this.icon,'<strong class="mx-2 heading">').concat(this.title,'</strong> <small class="ml-3">(').concat(this.year,")</small></h3>")),c=$('<div class="genres row mx-0 p-2 mb-0"></div>');c.append('<div class="d-inline-block"><strong>Genres:</strong></div>'),this.genre.forEach(function(t){c.append('<div class="ml-2 d-inline-block">'.concat(t.name,"</div>"))}),s.append(i),n.append(s,c),a.append(n,$("<hr>"));var o=$('<main class="col-12 mx-0"></main>'),r=$('<div class="row"></div>'),l=$('<div class="col-12 col-sm-4 d-flex justify-content-center img-wrapper"></div>');l.append(' <img class="p-2 pl-2" src='.concat(this.lrgImage," alt=").concat(this.title," />")),r.append(l);var d=$('<div class="content col-12 col-sm-8"></div>'),p=$('<div class="controls d-flex justify-content-around align-items-center"></div>').append('<div class="rating">\n                    <div class= "d-flex flex-column">\n                    <div><strong>rating</strong></div>\n                    <div><strong class="heading">'.concat(this.rating,"%</strong></div>\n                    </div>\n                    </div>")),h=$('<div class="d-flex justify-content-center align-items-center btn-add-to-list btn-default">\n\t\t\t\t<i class="fas fa-plus my-0"></i>\n\t\t\t</div>').on("click",function(){buttonControls.add(e,"preview")}),g=$('<div class="d-flex justify-content-center align-items-center btn-thumbs-up btn-success">\n\t\t\t\t<i class="fas fa-thumbs-up"></i>\n\t\t\t</div>').on("click",function(){buttonControls.like(e,"preview")}),m=$('<div class="d-flex justify-content-center align-items-center btn-thumbs-down btn-danger">\n\t\t\t\t<i class="fas fa-thumbs-down"></i>\n\t\t\t</div>').on("click",function(){buttonControls.dislike(e,"preview")}),u=$('<div class="d-flex justify-content-center align-items-center btn-delete btn-default">\n\t\t\t\t<i class="fas fa-trash-alt"></i>\n\t\t\t</div>').on("click",function(){buttonControls.delete(e,"preview")}),v=$('<div class="d-flex justify-content-center align-items-center btn-back btn-default">'.concat('<i class="fas fa-times"></i>',"</div>")).on("click",function(){buttonControls.back(e,t)});"search"==t||"recommendation"==t||"actorSearch"==t?p.append(h,v):p.append(g,m,u,v);var f=$('\n            <p><strong class="heading">Description:</strong></p>\n\t\t\t<div id="desc-box">\n\t\t\t\t<p>'.concat(this.longDescription,"</p>\n\t\t\t</div>\n\t\t\t"));d.append(p,f),r.append(d);var y=$('<section class="col-12 additional-info">');o.append(r,y);var b=$('<datalist id="tags-list"></datalist>');Object.keys(watchList.tags).forEach(function(t){b.append('<option value="'.concat(t,'"></option>'))});var w=$('<span class="ml-2 collection-tag"></span>').append('<input class="add-tag" list="tags-list" placeholder="add new"></input>',b),k=$('<div class=" d-flex flex-wrap preview-tags"></div>').on("keydown","input",function(t){if($(".add-tag").val().length>=10&&$(".add-tag").css("width","".concat(120+9*($(".add-tag").val().length-9),"px")),13==t.keyCode){watchListDom.addTag($(".add-tag").val(),e.dbid);var a=$('\n                        <input list="tags-list" placeholder="add new"></input>\n                        <datalist id="tags-list"></datalist>\n                    ').addClass("add-tag"),n=$('<span class="collection-tag"></span>').append(a);$(".preview-tags").html("").append(n).append(e.updateTags()),e.updateCardTags(),watchListDom.renderDataLists(),watchList.updateLocalStorage()}}).focusin(function(){$(".help").toggleClass("d-none")}).focusout(function(){$(".help").toggleClass("d-none")}).append(w,this.updateTags()),L=$('<textarea id="notes" class="notes-area" placeholder="Any Additional notes about this '.concat(this.type,'" rows="5">').concat(this.note,"</textarea>")).on("input",function(t){e.note=$(t.target).val(),watchList.updateLocalStorage()}),x=$('<div class="btn btn-default text-center my-2 w-100"></div>');"search"==t||"recommendation"==t||"actorSearch"==t?(x.html("Add Item To List"),x.on("click",function(){buttonControls.add(e,"preview")})):(x.html("Update Note"),x.on("click",function(){closePopUp()}));var _=$('<section class="col-12"></section>').append('<hr><p><strong class="heading">Tags</strong></p>',k,'<p class="d-none help"><small>press enter to add your new tag</small></p>',L,x);a.append(o,_),a.append("<hr>");var T=$("<section></section>").append('<div class="row mx-0 px-1"><p><strong>Top Billed Cast</strong></div>'),C=$('<div class="row mx-0 px-1"></div>');return this.cast?this.cast.forEach(function(t){var e="https://image.tmdb.org/t/p/w185";t.profile_path?e+=t.profile_path:e="./assets/images/no-profile.jpeg",C.append($('<div class="col-6 col-md-3 actor-thumb">\n                \t\t\t<div class="img-container">\n                    \t\t\t<img src="'.concat(e,'" alt="').concat(t.name,'">\n                \t\t\t</div>\n                \t\t\t<p class="text-center"><small>').concat(t.name,"</small></p>\n            \t\t\t</div>")))}):C.append("<p>No Cast Identified</p>"),T.append(C),a.append(T),a}},{key:"card",value:function(t){var e=this,a=$("<article id=".concat(this.id,' class="card"></article>')),n=$('<div class="card-inner"></div>'),s=$('<div class="card-bg"></div>');s.css("background-image",'url("'.concat(this.lrgImage,'")')),n.append(s);var i=$('<div class="card-info p-2"></div>'),c=$('<header class="card-head"></header>'),o=$('<div class="row mx-0"><h5 class="text-left">'.concat(this.icon,'<span class="heading mx-2">').concat(this.title,'</span><span class="year"> - ').concat(this.year," </span></h5></div>"));c.append(o);var r=$('\n                                    <p><strong class="heading">Description</strong></p>\n                                    <p><small>'.concat(this.shortDescription,"</small></p>\n                                    <hr>\n                                ")),l=$('<p><strong class="heading">Tags:</strong></p>'),d=$('<div id="collections-'.concat(this.id,'" class="d-flex flex-wrap"></div>')),p=$('<div class="btn btn-more-info text-center mt-2">more info</div>');if(p.on("click",function(t){buttonControls.preview(e,"card")}),t){var h=$('<div class="btn btn-more-info text-center mt-3">add to list</div>');h.on("click",function(){buttonControls.add(e,t)}),i.append(c,r,p,h)}else{var g=$('<div class="d-flex justify-content-around"></div>'),m=$('<div class="d-flex justify-content-center align-items-center btn-actions btn-default">\n\t\t\t\t\t<i class="fas fa-trash-alt"></i>\n\t\t\t\t</div>'),u=$('<div class="d-flex justify-content-center align-items-center btn-actions btn-success">\n\t\t\t\t\t<i class="fas fa-thumbs-up"></i>\n\t\t\t\t</div>').on("click",function(){buttonControls.like(e)}),v=$('<div class="d-flex justify-content-center align-items-center btn-actions btn-danger">\n\t\t\t\t\t<i class="fas fa-thumbs-down"></i>\n\t\t\t\t</div>').on("click",function(){buttonControls.dislike(e)});m.on("click",function(){buttonControls.delete(e)}),g.append(u,m,v),i.append(c,r,l,d,p,g)}return n.append(i),a.append(n),a}},{key:"updateTags",value:function(){var t=this,e="";return Object.entries(watchList.tags).forEach(function(a){a[1].includes(t.dbid)&&(e+='<span class="ml-2 collection-tag">'.concat(a[0],"</span>"))}),e}},{key:"updateCardTags",value:function(){var t=this.updateTags();t.length<=0&&(t='<span class="collection-tag mr-1 mb-1">no collections</span>'),$("#collections-".concat(this.id)).html(t)}}]),t}(),movie=function(t){"use strict";function e(t){var a;return _classCallCheck(this,e),(a=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).type="movie",a.icon='<i class="fas fa-film m-1"></i>',a.director=t.director,a.rating=t.rating,a.cast=t.cast,a.genre=t.genre,a.card=a.card.bind(_assertThisInitialized(a)),a.getRecommendations=a.getRecommendations.bind(_assertThisInitialized(a)),a}return _inherits(e,watchItem),_createClass(e,[{key:"card",value:function(t){var a=_get(_getPrototypeOf(e.prototype),"card",this).call(this,t),n=$('<div class="row mx-0"><p class="text-right"><small><strong class="mr-2">Directed By:</strong>'.concat(this.director,"</p></small></div>"));return a.find(".card-head").append(n),a}},{key:"getRecommendations",value:function(t){"card"==t&&makePopUp();var e=this.genre[randomIndex(this.genre.length)],a=this.cast[randomIndex(this.cast.length)];$("#add-or-edit-container").html('<div class="p-2">\n\t\t\t\t<p class="text-center">\n\t\t\t\t\t<strong>Because you liked '.concat(this.title,' you might also like </strong>\n\t\t\t\t</p>\n        \t\t<p class="text-center">Because you liked ').concat(a.name,'</p>\n\t\t\t\t<div id="actor-rec" class="d-flex justify-content-center">\n\t\t\t\t\t<img src="./assets/images/loading.gif" alt="loader">\n        \t\t</div>\n        \t\t<p class="text-center">Because you liked a ').concat(e.name,' movie</p>\n\t\t\t\t<div id="genre-rec" class="d-flex justify-content-center"">\n\t\t\t\t\t<img src="./assets/images/loading.gif" alt="loader">\n        \t\t</div>\n        \t</div>'));var n=$('<div class="btn btn-default text-center">No Thanks</div>');n.on("click",function(){closePopUp()}),tmdb.getObjects({listType:"recommendations",recType:"".concat(this.type," actor"),id:a.id,type:this.type},function(t){$("#actor-rec").html(""),$("#actor-rec").append(t[0].card("recommendation"))}),tmdb.getObjects({listType:"recommendations",recType:"".concat(this.type," genre"),id:e.id,type:this.type},function(t){$("#genre-rec").html(""),$("#genre-rec").append(t[0].card("recommendation"))});var s=$('<div class="d-flex justify-content-center mb-5"></div>').append(n);$("#add-or-edit-container").append(s)}}]),e}(),tv=function(t){"use strict";function e(t){var a;return _classCallCheck(this,e),(a=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).type="tv",a.icon='<i class="fas fa-tv m-1"></i>',a.rating=t.rating,a.cast=t.cast,a.genre=t.genre,a.lastEpisode=t.lastEpisode,a.nextEpisode=t.nextEpisode,a.seasons=t.seasons,a.epTracker=t.epTracker,a.searchItem=a.searchItem.bind(_assertThisInitialized(a)),a.itemPreview=a.itemPreview.bind(_assertThisInitialized(a)),a.card=a.card.bind(_assertThisInitialized(a)),a.getRecommendations=a.getRecommendations.bind(_assertThisInitialized(a)),a.updateTags=a.updateTags.bind(_assertThisInitialized(a)),a}return _inherits(e,watchItem),_createClass(e,[{key:"itemPreview",value:function(t){var a=this,n=_get(_getPrototypeOf(e.prototype),"itemPreview",this).call(this,t),s=$('<div id="seasons" class="d-flex flex-wrap"></div>'),i=$('<div id="episodes" class="d-flex flex-wrap"></div>'),c=0,o=0;"Season 1"==this.epTracker[0].name&&(o=1),this.epTracker.forEach(function(t){var e=$('<span id="s-'.concat(o,'" class="mx-2 season-button">').concat(t.name,"</span>"));a.epTracker[c].episodes.every(function(t){return t.watched})&&e.addClass("watched"),e.on("click",function(t){$("#episodes").html(""),$(t.target).addClass("selected"),$(t.target).siblings().removeClass("selected");var e=t.target.id.split("-")[1];o!=c&&(e-=1),a.epTracker[e].episodes.forEach(function(e){var n="";e.watched&&(n="watched");var s=$('\n                    \t\t<span id="S-'.concat(t.target.id.split("-")[1],"-E-").concat(e.episode,'" \n\t\t\t\t\t\t\tclass="mx-2 season-button ').concat(n,'">E-').concat(e.episode,"</span>")).on("click",function(t){$(t.target).addClass("selected"),$(t.target).siblings().removeClass("selected"),$(".ep-details").html("fetching episode information...");var e=t.target.id.split("-");showEpisode(a,e[1],e[3]),watchList.updateLocalStorage()});$("#episodes").append(s)})}),s.append(e),c+=1,o+=1});var r=$('\n        <hr>\n        <div class="d-flex justify-content-around">\n            <p class="heading">Episode Tracker</p>\n\t\t\t<div class="btn btn-default right" data-toggle="collapse" \n\t\t\thref="#ep-tracker" role="button" aria-expanded="false" \n\t\t\taria-controls="ep-tracker">\n                <i class="fas fa-angle-right"></i>\n            </div>\n        </div>\n        <div class="collapse " id="ep-tracker">\n            <div id="ep-tracker-content">\n            </div>\n\t\t</div>').on("click",function(t){$(t.target).closest("div").hasClass("right")?$(t.target).closest("div").switchClass("right","down",500):$(t.target).closest(".btn").switchClass("down","right",500)});return r.find("#ep-tracker-content").append("<p><strong>Seasons</strong></p>",s,'<p class="mt-3"><strong>Episodes</strong></p>',i,'<div class="ep-details"></div>'),n.find(".additional-info").append(r),n}},{key:"card",value:function(t){var a=_get(_getPrototypeOf(e.prototype),"card",this).call(this,t);if(this.nextEpisode){var n=$('<div class= "row d-block mx-0 mb-0 text-right" >\n                <p class="text-right mb-0"><small>\n                <strong class="mr-2">Next Episode:</strong>\n                '.concat(this.nextEpisode.name,"</p></small>\n\t\t\t\t<p>\n\t\t\t\t\t<small>\n\t\t\t\t\t\tS").concat(this.nextEpisode.season_number,"\n\t\t\t\t\t\tE").concat(numberString(this.nextEpisode.episode_number)," -\n\t\t\t\t\t\t").concat(tmdbDateFix(this.nextEpisode.air_date)," \n\t\t\t\t\t</small>\n\t\t\t\t</p>\n\t\t\t\t</div >"));a.find(".card-head").append(n)}return a}},{key:"getRecommendations",value:function(t){"card"==t&&makePopUp(),$("#add-or-edit-container").html('<div class="p-2"><p class="text-center"><strong>Because you liked '.concat(this.title,' you might also like </strong></p>\n\t\t<div id="actor-rec" class="d-flex justify-content-center">\n\t\t\t<img src="./assets/images/loading.gif" alt="loader">\n        </div>\n\t\t<div id="genre-rec" class="d-flex justify-content-center">\n\t\t\t<img src="./assets/images/loading.gif" alt="loader">\n        </div>\n        </div>\n        '));var e=$('<div class="btn btn-default text-center">No Thanks</div>');e.on("click",function(){closePopUp()}),tmdb.getObjects({listType:"recommendations",recType:"tv recommendations",id:this.dbid,type:this.type},function(t){$("#actor-rec").html(""),$("#genre-rec").html("");var e=randomIndex(t.length),a=randomIndex(t.length);e==a&&(a-=1),$("#actor-rec").append(t[e].card("recommendation")),$("#genre-rec").append(t[a].card("recommendation"))});var a=$('<div class="d-flex justify-content-center mb-5"></div>').append(e);$("#add-or-edit-container").append(a)}}]),e}();function performFilter(t,e){"all"==e?watchListDom.render(watchList.contents):watchListDom.filter(t,e),menuActive=!1,closeDrawerMenu()}function closeDrawerMenu(){menuActive=!1,$("#menu").animate({left:"-=240"},500)}showEpisode=function(t,e,a){tmdb.getEpisodeName(t.dbid,e,a,function(n){"Season 1"==t.epTracker[0].name&&(e-=1),$(".ep-details").html(""),$(".ep-details").append('\n\t\t\t\t<p class="mt-2 mb-0 text-center heading">\n\t\t\t\t\t<strong>'.concat(n.name,'</strong>\n\t\t\t\t</p>\n\t\t\t\t<p class="text-right">\n\t\t\t\t\t<small>first aired: ').concat(tmdbDateFix(n.air_date),'</small>\n\t\t\t\t</p>\n\t\t\t\t<p class="desc-box">').concat(n.overview,"</p>\n\t\t\t"));var s="Mark as Watched";t.epTracker[e].episodes[a-1].watched&&(s="Unmark as Watched");var i=$('\n\t\t\t\t<div id="confirm-button" class="btn-default w-23 mx-auto text-center">\n\t\t\t\t\t'.concat(s,"\n\t\t\t\t</div>")).on("click",function(){t.epTracker[e].episodes[a-1].watched?(t.epTracker[e].episodes[a-1].watched=!1,$("#S-".concat(e,"-E-").concat(a)).removeClass("watched"),$("#confirm-button").html("Mark as Watched"),t.epTracker[e].episodes.every(function(t){return t.watched})||$("#s-".concat(e)).removeClass("watched")):(t.epTracker[e].episodes[a-1].watched=!0,$("#S-".concat(e,"-E-").concat(a)).addClass("watched"),$("#confirm-button").html("Unmark as Watched"),t.epTracker[e].episodes.every(function(t){return t.watched})&&$("#s-".concat(e)).addClass("watched")),watchList.updateLocalStorage()});$(".ep-details").append(i)})},buttonControls={add:function(t,e){(closePopUp(),"preview"!=e)?tmdb.getDetails({id:t.dbid,type:t.type}).then(function(a){var n=tmdb["make".concat(capitalise(t.type),"Object")](a);"recommendation-card"==e?(watchList.add(n),makePopUp("add",n.title)):watchListDom.add(n)}):watchListDom.add(t)},delete:function(t){watchListDom.remove(t.id.split("-")[1],t.dbid),watchListDom.render(watchList.contents),closePopUp()},preview:function(t,e){("card"==e&&makePopUp(),t.cast)?($("#results").html(t.itemPreview("card"))):(tmdb.getDetails({id:t.dbid,type:t.type}).then(function(a){var n=tmdb["make".concat(capitalise(t.type),"Object")](a);"actorSearch"!=e?$("#results").html(n.itemPreview("search")):$("#results").html(n.itemPreview("actorSearch"))}),$("#results").html('\n\t\t\t\t<div class="d-flex flex-column justify-content-center align-items-center">\n\t\t\t\t<img src="./assets/images/loading.gif"></img>\n\t\t\t\t<p>Getting item preview</p>\n\t\t\t\t</div>\n\t\t\t'));watchListDom.renderDataLists(),$("#search-box").addClass("d-none").removeClass("d-flex")},like:function(t){watchList.addLike(t),watchListDom.render(watchList.contents),t.getRecommendations("card")},dislike:function(t){watchList.addDislike(t),watchListDom.render(watchList.contents),closePopUp()},back:function(t,e){var a=$("#results").attr("data-page");$("#search-box").removeClass("d-none").addClass("d-flex"),"search"==e||"actorSearch"==e?($("#results").html(""),"search"==e?searches[t.type]($("#search-box input").val(),a):searches.actorMovies({id:$("#results").attr("data-actorid"),name:$("#search-box input[type=text]").val(),page:a})):closePopUp()}},menuActive=!1,$(document).on("click",function(t){"toggle-menu"==$(t.target).attr("id")?menuActive?(menuActive=!1,closeDrawerMenu()):(menuActive=!0,$("#menu").animate({left:"+=240"},500)):menuActive&&null==t.target.closest("aside")&&closeDrawerMenu()}),$("#category-list .add-new").on("click",function(){makePopUp("manageFilters")}),$("#tv-by-genre").on("click",function(){$("#tv-genre-search").slideToggle("slow"),$("#tv-genre-search").siblings("p").slideUp()}),$("#movie-by-genre").on("click",function(){$("#movie-genre-search").slideToggle("slow"),$("#movie-genre-search").siblings("p").slideUp()}),$("#movie-genres-list").on("change",function(){recommendations.recommendationsList({id:$("#movie-genres-list").val(),type:"movie",recType:"movie genre",page:1})}),$("#tv-genres-list").on("change",function(){recommendations.recommendationsList({id:$("#tv-genres-list").val(),type:"tv",recType:"tv genre",page:1})});var addMenuVis=!1;function closePopUp(){var t=this;$("#search-box").removeClass("d-none").addClass("d-flex"),$(".obscure").fadeOut(200,function(){$(t).css("display","none")})}function makePopUp(t,e){$("#add-or-edit-container").html(""),$(".obscure").fadeIn(300),$(".obscure").css("display","block"),"manageFilters"==t?manageFilters():"help"==t?displayHelp():"reset"==t?resetData():"add"==t?addingItem(e):addNewMenu(t)}function addingItem(t){$("#add-or-edit-container").html('<div class="p-4"><p class="heading text-center">'.concat(t," has been added</p></div>"));var e=$('<button type="button" class="btn btn-default">Keep Browsing</button>').on("click",function(){closePopUp()}),a=$('<button type="button" class="btn btn-default">View My List</button>').on("click",function(){closePopUp(),watchListDom.render(watchList.contents)}),n=$('<div class="d-flex justify-content-around mb-4"></div>').append(e,a);$("#add-or-edit-container").append(n)}function manageFilters(){$("#add-or-edit-container").html("");var t=$('<div class="manage-tags p-2"></div>'),e=$('<h3 class="heading text-center">Add or Edit Tags</h3><hr>'),a=$('<div class="d-flex justify-content-center align-items-center new-collection-wrapper">'),n=$("<label>Add New Tag</label>"),s=$('<input id="collection-input" type="text"></input>').on("input keydown",function(t){13==t.keyCode&&($("#collection-input").val().length>0&&(watchListDom.addTag($("#collection-input").val()),manageFilters()),$(t.target).blur())}).focusin(function(t){$(t.target).siblings().animate({"font-size":"0.5rem",bottom:"25px"},"linear")}).focusout(function(t){0==$(t.target).val().length&&$(t.target).siblings().animate({"font-size":"1rem",bottom:"0px"},"linear")}),i=$('<div class="btn d-flex justify-content-center align-items-center my-0"><i class="fas fa-plus"></i></div>');i.on("click",function(){$("#collection-input").val().length>0&&(watchListDom.addTag($("#collection-input").val()),manageFilters())});var c=$('<div class="input-box-wrapper my-0"></div>').append(n,s);a.append(c,i),t.append(e,a),Object.keys(watchList.tags).length>0&&Object.keys(watchList.tags).forEach(function(e){var a=$('<div class="d-flex justify-content-around tag-wrapper"></div>');a.hover(function(t){$(t.target).find(".fa-arrow-right").removeClass("fa-arrow-right").addClass("fa-pencil-alt")},function(t){$(t.target).find(".fa-pencil-alt").removeClass("fa-pencil-alt").addClass("fa-arrow-right"),$(t.target).find("input").blur()});var n=$('<input type="text" value='.concat(e,"></input>")).on("input",function(t){0==$(t.target).val().length?delete watchList.tags[e]:(watchList.tags[t.target.value]=watchList.tags[e],delete watchList.tags[e]),manageFilters(),watchList.updateLocalStorage()}),s=$('<div class="d-flex align-items-center"><i class="fas fa-arrow-right my-0"></i>'),i=$('<div class="d-flex justify-content-center align-items-center btn"><i class="far fa-trash-alt my-0"></i></i></div>').on("click",function(){watchListDom.removeTag(e),watchListDom.renderTags(),manageFilters()});a.append(s,n,i),t.append(a)}),$("#add-or-edit-container").append(t)}function addNewMenu(t){var e="Enter a";switch(t){case"person":e+="n Actor's Name";break;case"movie":e+=" Movie";break;case"tv":e+=" TV show"}"person"==t&&$("#add-or-edit-container").html("");var a=$('<div id="search-box" class="row d-flex mx-0 justify-content-center align-items-center"></div>'),n=$('<input type="text" placeholder="'.concat(e,'"></input>')).on("keydown",function(e){0==n.val().length&&$("#results").html('\n                            <div class="mt-5 text-center">\n                                <h1><i class="fas fa-search"></i></h1>\n                                <p>Please type above to search for media</p>\n                            </div>'),13==e.keyCode&&(n.val().length>0?(searches[t](n.val(),1),$(e.target).blur()):$("#search-box input").effect("shake"))}),s=$('<i class="fas fa-search ml-2 mr-4"></i>');a.append(s,n);var i=$('<div id="results" data-page=\'1\'>\n                        <div class="mt-5 text-center">\n                        <h1><i class="fas fa-search"></i></h1>\n                        <p>Please type above to search for media</p>\n                        </div>\n                    </div>');$("#add-or-edit-container").append(a,i)}function displayHelp(){$("#add-or-edit-container").html("");var t=$('<div class="help-menu p-4"></div>').append('<h3 class="heading text-center mb-4">Welcome to Watch List</h3>\n\t\t<p class="mb-2">\n\t\t\tHas anybody ever recommended a great Movie to you, and then when you sat down to watch it,\n\t\t\tyou couldn\'t remember what it was called?\n\t\t</p>\n\t\t<p class="mb-2">\n\t\t\tHave you ever been mid-way through a show then taken a break and forgotten what episode you were on? \n\t\t</p>\n\t\t<p class="mb-4">\n\t\t\tIf you answered yes to any of these questions then WatchList is for you allows you to keep track of any Movie or\n\t\t\tTV recommendations that you have received. It uses The TMBD API to search for up-to-date information about media \n\t\t\tthat you want to remember.\n        </p>\n\t\t<p class="heading mb-3"> \n\t\t\t<strong>Getting Started:</strong> \n\t\t</p>\n        <ul>\n            <li>search for specific using the <i class="fas fa-plus my-0"></i> icon</li>\n            <li>Browse new and popular items by selecting one of the recommendations from the menu</li> \n        </ul>\n\t\t<p class="my-2">\n\t\t\t<small class="text-center">\n\t\t\t\t<strong>User History and Watch List are stored using your browsers local storage</strong>\n\t\t\t</small>\n\t\t</p>'),e=$('<button type="button" class="btn btn-default mx-auto">OK</button>').on("click",function(){watchList.returningUser=!0,watchList.updateLocalStorage(),closePopUp()}),a=$('<div class="d-flex justify-content-center mb-5"></div>').append(e);$("#add-or-edit-container").append(t,a)}function resetData(){$("#add-or-edit-container").html("");var t=$('<div class="reset-menu p-2"></div>').append('\n        <h3 class="heading text-center mb-4">Delete Everything?</h3>\n\t\t<p class="mb-1">\n\t\t\tThank you for using WatchList, I hope you enjoyed your time here and I\'m sorry that maybe things didn\'t \n\t\t\twork out quite as well as you hoped\n\t\t</p>\n\t\t<p class="mb-3">\n\t\t\tPlease be cautious, there is no going back from this point.\n\t\t</p>\n\t\t<p>\n\t\t\tBy clicking the button below you will delete:\n\t\t</p>\n        <ul class="mb-4">\n        \t<li>The current watchlist</li>\n        \t<li>All your custom tags and groups</li>\n        \t<li>All the details about your watch history</li>\n        </ul>\n        '),e=$('<button type="button" class="btn btn-danger my-3">Yes Please, delete all my data</button>').on("click",function(){watchListDom.resetAll(),closePopUp()}),a=$('<div class="d-flex justify-content-center"></div>').append(e);t.append(a),$("#add-or-edit-container").append(t)}["movie","tv","person"].forEach(function(t){$("#".concat(t)).on("click",function(){makePopUp("".concat(t)),$("#".concat(t)).blur()})}),$(document).on("click",function(t){if("add"==$(t.target).closest("div[id]").attr("id")){var e=60;["movie","tv","person"].forEach(function(t){$("#".concat(t)).animate({display:"toggle",top:e,"z-index":4},500,function(){$("#".concat(t)).show(),addMenuVis=!0}),e+=50})}else addMenuVis&&["movie","tv","person"].forEach(function(t){$("#".concat(t)).animate({display:"toggle",top:7,"z-index":-1},500,function(){$("#".concat(t)).hide(),addMenuVis=!1})})}),$(document).on("click",function(t){$(t.target).hasClass("obscure")&&closePopUp()});var recommendations={recommendationsList:function(t){1==t.page&&closeDrawerMenu(),$("#watch-list").html('<div class="no-results text-center">\n                <img src="./assets/images/loading.gif">\n                <p>fetching your recommendations</p> \n                </div>\n            '),tmdb.getObjects({type:t.type,listType:"recommendations",recType:t.recType,page:t.page,id:t.id},function(e){if(watchListDom.render(e,"recommendation-card"),20==e.length){$("#watch-list").append('<div id="next-twenty" \n                        class="d-flex button-wrapper  \n                        w-100">\n                        </div>');var a=$('<div class="btn btn-default ml-auto my-5"> \n                            Next 20 <i class="fas fa-arrow-right ml-2"></i>\n                        </div>').on("click",function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,recommendations.recommendationsList({type:t.type,recType:t.recType,page:t.page+1,id:t.id})}),n=$('<div class="btn btn-default my-5"> \n                            <i class="fas fa-arrow-left"></i> <span class="ml-2">prev 20</span>\n                        </div>').on("click",function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,recommendations.recommendationsList({type:t.type,recType:t.recType,page:t.page-1,id:t.id})});t.page>1?$("#next-twenty").append(n,a):$("#next-twenty").append(a)}})}},searches={movie:function(t,e){var a=Math.ceil(e/2);tmdb.getObjects({type:"movie",terms:t,page:a,listType:"search"},function(a,n){if(a=e%2!=0?a.slice(0,9):a.slice(10,19),$("#results").html(""),0==a.length)$("#results").append("<p>no results found please change your search criteria</p>");else{var s=$("<div></div>");a.forEach(function(t){s.append(t.searchItem())}),$("#results").append(s),$("#results").append(paginationControls(e,t,"movie",n,a.length))}}),$("#results").html('\n            <div class="no-results text-center">\n            <img src="./assets/images/loading.gif" alt="loader">\n            <p>searching movies....</p>\n            </div>')},tv:function(t,e){$("#results").html('\n            <div class="no-results text-center">\n            <img src="./assets/images/loading.gif" alt="loader">\n            <p>searching......</p>\n            </div>');var a=Math.ceil(e/2);tmdb.getObjects({type:"tv",terms:t,page:a,listType:"search"},function(a,n){if(a=e%2!=0?a.slice(0,9):a.slice(10,19),$("#results").html(""),0==a.length)$("#results").append("<p>no results found please change your search criteria</p>");else{var s=$("<div></div>");a.forEach(function(t){s.append(t.searchItem())}),$("#results").append(s),$("#results").append(paginationControls(e,t,"tv",n,a.length))}})},person:function(t,e){$("#results").html('\n            <div class="no-results text-center">\n            <img src="./assets/images/loading.gif" alt="loader">\n            <p>searching......</p>\n            </div>');var a=Math.ceil(e/2);tmdb.getSearchResults({type:"person",terms:t,page:a,listType:"search"}).then(function(a){var n=a.total_pages;if(a=a.results,a=e%2!=0?a.slice(0,9):a.slice(10,19),$("#results").html(""),0==a.length)$("#results").append("<p>no results found please change your search criteria</p>");else{var s=$("<div></div>");a.forEach(function(t){var e=searches.personSearchItem({name:t.name,id:t.id,profile_path:t.profile_path}).on("click",function(){searches.actorMovies({id:t.id,name:t.name,page:1})});s.append(e)}),$("#results").append(s),$("#results").append(paginationControls(e,t,"person",n,a.length))}})},actorMovies:function(t){$("#results").html(""),$("#results").html('\n                    <div class="no-results text-center">\n                        <img src="./assets/images/loading.gif" alt="loader">\n                        <p>searching......</p>\n                    </div>');var e=$("<div></div>");$("#search-box input[type=text]").val(t.name),tmdb.getObjects({listType:"recommendations",recType:"movie actor",id:t.id,type:"movie",page:t.page},function(a,n){$("#results").html(""),$("#results").attr("data-actorid",t.id),a.forEach(function(t){e.append(t.searchItem(!0))}),$("#results").append(e),$("#results").append(paginationControls(t.page,{id:t.id,name:t.name},"actor-movies",n,a.length))})},personSearchItem:function(t){var e="https://image.tmdb.org/t/p/w185".concat(t.profile_path);t.profile_path||(e="./assets/images/no-profile.jpeg");var a=$('<div class="result row pt-2 mx-0 "></div>'),n=$('<div class="col-3 col-offset-2 "></div>'),s=$('<div class="col-7 mt-3"></div>');return n.append("<img src=".concat(e,' class="result-thumb mx-auto d-block" alt=').concat(t.name," />")),s.append('<h6 class="result-title"><strong class="heading">'.concat(t.name,"</strong></h6>")),a.append(n,s),a}};function paginationControls(t,e,a,n,s){var i=$('<div class="d-flex justify-content-around mt-2 mb-2"></div>'),c=$('<div class="result-btn">prev</div>').on("click",function(){var n=t-1;$("#results").attr("data-page",n),n>0&&("actor-movies"==a?searches.actorMovies({id:e.id,name:e.name,page:n}):searches[a](e,n))}),o=$('<div class="result-btn">next</div>').on("click",function(){var i=t+1;$("#results").attr("data-page",i),i<=2*n&&s>=9&&("actor-movies"==a?searches.actorMovies({id:e.id,name:e.name,page:i}):searches[a](e,i))});return t>1&&i.append(c),t<=2*n&&s>=9&&i.append(o),i}function showWarning(t){$("#maxReq-Waring").html(t),$("#maxReq-Waring").removeClass("d-none");var e=8;$("#maxReq-Waring span").html(e);var a=setInterval(function(){e--,$("#maxReq-Waring span").html(e),0==e&&(clearInterval(a),$("#maxReq-Waring").addClass("d-none"))},1e3)}var watchHistory={render:function(){closeDrawerMenu(),$("#watch-list").html(""),$("#watch-list").append(watchHistory.getCurrentListStatsHTML(),watchHistory.historyCard("movie"),watchHistory.historyCard("tv"))},getCurrentListStatsHTML:function(){var t=0,e=0,a={};watchList.contents.forEach(function(n){"movie"==n.type?t+=1:e+=1,n.genre.forEach(function(t){a[t.name]?a[t.name].push(n):a[t.name]=[n]})});var n=$('<article class="card info-card p-3">\n                            <header class="mb-2">\n                            <h3 class="heading">Current List</h3>\n                            </header>\n                            <hr>\n                            <main>\n                            <div class="row mx-0 "><p>You have <strong>'.concat(t+e,'</strong> items in your list</P>\n                            <div class= "row breakdown">\n                                <div class="col-12">\n                                    <p><strong>Movies:</strong><span class="ml-4">').concat(t,'</span></p>\n                                </div>\n                                <div class="col-12">\n                                    <p><strong>TV Shows:</strong><span class="ml-4">').concat(e,'</span></p>\n                                </div>\n                            </div>\n                            <hr>\n                            <div id="list-genres" class= "row genres">\n                               <div class="col-12"><p class="heading"> Genres: </p> </div>\n                            </div>\n                            </main>\n                            </article>\n        '));return Object.keys(a).forEach(function(t){var e=$('\n                <div class="col-12 mx-0">\n                    <div class="col-12 genre d-flex justify-content-between my-1">\n                            <p>\n                                <strong>'.concat(t,"</strong> : <span>").concat(a[t].length,'</span>\n                            </p>\n                        <div class="btn btn-default right" type="button" data-toggle="collapse" \n                        data-target="#').concat(t.replace(/[^A-Za-z0-9]+/g,"-"),'-items" aria-expanded="false" aria-controls="').concat(t.replace(/[^A-Za-z0-9]+/g,"-"),'-items">\n                                <i class="fas fa-angle-right"></i>\n                        </div>\n                    </div>\n                    <div class="collapse" id="').concat(t.replace(/[^A-Za-z0-9]+/g,"-"),'-items">\n                    </div>\n                </div>')).on("click",function(t){$(t.target).closest("div").hasClass("right")?$(t.target).closest("div").switchClass("right","down",500):$(t.target).closest(".btn").switchClass("down","right",500)});n.find("#list-genres").append(e),a[t].forEach(function(e){var a=$('<div class="col-12 d-flex align-items-center overview-item">\n                    <div class="row px-0 mx-0 w-100 my-2">\n                        <div class="col-4 px-0">\n                            <img width=100% src="'.concat(e.thumb,'" alt="').concat(e.title,'">\n                        </div>\n                        <div class="col px-0 text-center">\n                            <p> <strong>').concat(e.title,"</strong></p>\n                            <p> ").concat(e.year," </p>\n                        </div>\n                    <div>\n                </div>")).on("click",function(){makePopUp(e.type),$("#search-box").addClass("d-none").removeClass("d-flex"),$("#results").html(e.itemPreview("recommendation"))});n.find("#".concat(t.replace(/[^A-Za-z0-9]+/g,"-"),"-items")).append(a)})}),n},historyCard:function(t){var e=$('\n            <article class="card info-card p-3">\n                <header class="mb-2">\n                    <h3 class="heading">'.concat(capitalise(t)," History</h3>\n                    <hr>\n                </header>\n                <section>\n                    <p>You have watched <strong>").concat(watchList.analytics[t].likes+watchList.analytics.movie.dislikes,'</strong> movies on Watch List</p>\n                    <p><strong>Likes:</strong> <span class="ml-4">').concat(watchList.analytics[t].likes,'</span></p>\n                    <p><strong>Dislike:</strong> <span class="ml-4">').concat(watchList.analytics[t].dislikes,"</span></p>\n                    </hr>\n                </section>\n            </article>\n                ")),a=$('\n            <table class="table table-hover">\n                <thead>\n                    <tr>\n                        <th scope="col">Last 5 '.concat(capitalise(t),"</th>\n                    </tr>\n            </thead>\n            </table>\n            ")),n=$("<tbody></tbody>");return watchList.analytics[t].lastFive.forEach(function(e){var a=$("<tr><td>".concat(e.title,"</td></tr>")).on("click",function(){makePopUp(),$("#search-box").addClass("d-none").removeClass("d-flex"),$("#results").html('\n                        <div class="no-results text-center">\n                            <img src="./assets/images/loading.gif" alt="loader">\n                            <p>fetching preview......</p>\n                        </div>'),tmdb.getDetails({type:t,id:e.id}).then(function(e){$("#results").html(""),$("#results").html(tmdb["make".concat(capitalise(t),"Object")](e).itemPreview("recommendation"))})});n.append(a)}),a.append(n),e.append(a),e}},watchList={details:{tvGenres:[],movieGenres:[]},analytics:{movie:{likes:0,dislikes:0,genres:{},lastFive:[]},tv:{likes:0,dislikes:0,genres:{},lastFive:[]}},contents:[],tags:{},returningUser:!1,load:function(){if(window.localStorage.getItem("watchListData")){var t=JSON.parse(window.localStorage.getItem("watchListData"));if(t.list.contents&&t.list.contents.forEach(function(t){switch(t.type){case"movie":watchList.add(new movie({dbid:t.dbid,title:t.title,thumb:t.thumb,lrgImage:t.lrgImage,longDescription:t.longDescription,year:t.year,genre:t.genre,note:t.note,director:t.director,rating:t.rating,cast:t.cast}));break;case"tv":watchList.add(new tv({dbid:t.dbid,title:t.title,thumb:t.thumb,lrgImage:t.lrgImage,longDescription:t.longDescription,year:t.year,genre:t.genre,note:t.note,rating:t.rating,cast:t.cast,lastEpisode:t.lastEpisode,nextEpisode:t.nextEpisode,seasons:t.seasons,epTracker:t.epTracker}))}}),t.list.tags&&(watchList.tags=t.list.tags),Object.keys(watchList.tags).forEach(function(t){0==watchList.tags[t].length&&delete watchList.tags[t]}),t.list.analytics&&(t.list.analytics.movie&&(watchList.analytics.movie=t.list.analytics.movie),t.list.analytics.tv&&(watchList.analytics.tv=t.list.analytics.tv)),t.list.details.movieGenres.length>1&&t.list.details.tvGenres.length>1)watchList.details.movieGenres=t.list.details.movieGenres,watchList.details.tvGenres=t.list.details.tvGenres;else{var e=tmdb.getGenres("movie"),a=tmdb.getGenres("tv");Promise.all([e,a]).then(function(t){watchList.details.movieGenres=t[0].genres,watchList.details.tvGenres=t[1].genres,watchListDom.renderDataLists()})}t.list.returningUser&&(watchList.returningUser=t.list.returningUser),watchList.updateLocalStorage()}},add:function(t){var e=!1;return watchList.contents.forEach(function(a){a.dbid==t.dbid&&(e=!0)}),!e&&(watchList.contents.push(t),watchList.updateLocalStorage(),!0)},remove:function(t){t>=0&&t<watchList.contents.length&&(watchList.contents.splice(t,1),watchList.updateLocalStorage())},filter:function(t,e){return"type"==t?watchList.contents.filter(function(a){return a[t]==e}):watchList.contents.filter(function(t){if(watchList.tags[e].includes(t.dbid))return!0})},addTag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;Object.keys(watchList.tags).includes(t)?watchList.tags[t].push(e):watchList.tags[t]=void 0==e?[]:[e]},removeTag:function(t){delete watchList.tags[t]},addLike:function(t){watchList.analytics[t.type].likes++,t.genre&&t.genre.length>=1&&t.genre.forEach(function(e){watchList.analytics[t.type].genres[e.name]?watchList.analytics[t.type].genres[e.name]+=1:watchList.analytics[t.type].genres[e.name]=1}),watchList.analytics[t.type].lastFive.length>=5&&(watchList.analytics[t.type].lastFive=watchList.analytics[t.type].lastFive.slice(-4)),watchList.analytics[t.type].lastFive.push({id:t.dbid,title:t.title}),watchList.remove(t.id.split("-")[1]),watchList.updateLocalStorage()},addDislike:function(t){watchList.analytics[t.type].dislikes++,watchList.remove(t.id.split("-")[1]),watchList.updateLocalStorage()},updateLocalStorage:function(){var t=watchList;window.localStorage.setItem("watchListData",JSON.stringify({list:t}))},resetAll:function(){watchList.analytics={movie:{likes:0,dislikes:0,genres:{},lastFive:[]},tv:{likes:0,dislikes:0,genres:{},lastFive:[]},game:{likes:0,dislikes:0,genres:{},lastFive:[]},book:{likes:0,dislikes:0,genres:{},lastFive:[]}},watchList.details.movieGenres=[],watchList.details.tvGenres=[],watchList.contents=[],watchList.tags={},watchList.returningUser=!1,watchList.updateLocalStorage()}},randomIndex=function(t){return"number"!=typeof t?0:Math.floor(Math.random()*Math.floor(t))},capitalise=function(t){return"string"!=typeof t?"":1==t.length?t.charAt(0).toUpperCase():0==t.length?"":t.charAt(0).toUpperCase()+t.slice(1)},numberString=function(t){return t<10&&t>0?"0".concat(t):"".concat(t)},tmdbDateFix=function(t){if(t){var e=t.split("-");return"".concat(e[2],"/").concat(e[1],"/").concat(e[0])}return""},watchListDom={load:function(){watchList.load(),watchListDom.renderDataLists(),watchListDom.render(watchList.contents),watchListDom.renderTags()},add:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];watchList.add(t)?e&&watchListDom.render(watchList.contents):showWarning("item is already in watchlist did not add. click to close")},remove:function(t,e){watchList.remove(t),Object.keys(watchList.tags).forEach(function(t){watchList.tags[t].includes(e)&&(tagPosition=watchList.tags[t].indexOf(e),watchList.tags[t]=[].concat(_toConsumableArray(watchList.tags[t].splice(0,tagPosition)),_toConsumableArray(watchList.tags[t].splice(tagPosition+1))))}),watchListDom.renderTags(),watchListDom.render(watchList.contents)},filter:function(t,e){var a=watchList.filter(t,e);if(0==a.length){var n="";if("type"==t){var s="";switch(e){case"movie":s="".concat(capitalise(e),"s");break;case"tv":s="Tv Shows"}$("#view-title").html("<h6>".concat(s,"</h6>")),n='<div class="no-results text-center">\n                <h1>'.concat({movie:'<i class="fas fa-film"></i>',tv:'<i class="fas fa-tv"></i>'}[e],"</h1>\n                <h5>Currently you have no ").concat(s," in your list</h5>\n                <p>Click the add button to the right to start adding some ").concat(e,"s</p>\n                </div>")}else n='\n                <div class="no-results text-center">\n                <h5>Tags: '.concat(e,", no longer has any contents</h5>\n                </div>");$("#watch-list").html(n)}else watchListDom.render(a)},addTag:function(t,e){watchList.addTag(t,e),watchListDom.renderTags(),watchList.updateLocalStorage()},removeTag:function(t){watchList.removeTag(t),watchListDom.renderTags(),watchList.updateLocalStorage()},render:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.length>=1){var a=0;$("#watch-list").html(""),t.forEach(function(t){t.id="card-"+a,$("#watch-list").append(t.card(e)),t.updateCardTags(),a++})}else $("#watch-list").html('<div class="no-results text-center">\n                <h1><i class="fas fa-asterisk"></i></h1>\n                <h5>Currently you have no items in your list</h5>\n                <p>Click the add button to the right to start adding movies, \n                tv shows and games to your to watch list</p> \n                </div>');watchListDom.renderTags()},renderTags:function(){$("#category-list").html(""),0!=Object.keys(watchList.tags).length&&Object.entries(watchList.tags).forEach(function(t){var e=$("<li>".concat(t[0],"</li>")).on("click",function(){performFilter("tags",t[0])});$("#category-list").append(e)});var t=$("<li class='add-new'>Add or Edit Tags</li>");t.on("click",function(){makePopUp("manageFilters")}),$("#category-list").append(t),watchList.contents.forEach(function(t){t.updateCardTags()})},renderDataLists:function(){$("#movie-genres-list").html(""),$("#tv-genres-list").html(""),$("#tags-list-list").html(""),$("#movie-genres-list").append("<option>Select an item</option>"),$("#tv-genres-list").append("<option>Select an item</option>"),watchList.details.movieGenres.forEach(function(t){$("#movie-genres-list").append('<option value="'.concat(t.id,'">').concat(t.name,"</option>"))}),watchList.details.tvGenres.forEach(function(t){$("#tv-genres-list").append('\n            <option value="'.concat(t.id,'">').concat(t.name,"</option>"))}),Object.keys(watchList.tags).forEach(function(t){$("#tags-list").append('\n            <option value="'.concat(t,'"></option>\n            '))})},resetAll:function(){watchList.resetAll(),watchListDom.render(watchList.contents),watchListDom.renderTags()}};watchListDom.load(),watchListDom.render(watchList.contents),watchList.returningUser||makePopUp("help");